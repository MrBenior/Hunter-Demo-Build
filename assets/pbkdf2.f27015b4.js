import{c as y}from"./asn1.js.6aa87f69.js";import{r as K}from"./safe-buffer.43022900.js";import"./node-stdlib-browser.aee37c56.js";import{p as s0}from"./process.df46de55.js";import{b as E}from"./buffer.d6bf1362.js";import{r as e0}from"./inherits.804453d8.js";import{r as i0}from"./stream-browserify.3337c679.js";import{r as u0}from"./sha.js.8f738466.js";import{r as d0}from"./to-buffer.adf05e7c.js";var S={},F,Z;function t0(){if(Z)return F;Z=1;var m=Math.pow(2,30)-1;return F=function(w,_){if(typeof w!="number")throw new TypeError("Iterations not a number");if(w<0)throw new TypeError("Bad iterations");if(typeof _!="number")throw new TypeError("Key length not a number");if(_<0||_>m||_!==_)throw new TypeError("Bad key length")},F}var P,$;function a0(){if($)return P;$=1;var m;if(y.process&&y.process.browser)m="utf-8";else if(y.process&&y.process.version){var w=parseInt(s0.version.split(".")[0].slice(1),10);m=w>=6?"utf-8":"binary"}else m="utf-8";return P=m,P}var R,G;function c0(){if(G)return R;G=1;var m=4,w=new E.Buffer(m);w.fill(0);var _=8,o=16;function x(h){if(h.length%m!==0){var v=h.length+(m-h.length%m);h=E.Buffer.concat([h,w],v)}for(var b=new Array(h.length>>>2),p=0,r=0;p<h.length;p+=m,r++)b[r]=h.readInt32LE(p);return b}return R=function(v,b){var p=b(x(v),v.length*_);v=new E.Buffer(o);for(var r=0;r<p.length;r++)v.writeInt32LE(p[r],r<<2,!0);return v},R}var D,X;function h0(){if(X)return D;X=1;var m=c0();function w(r,l){r[l>>5]|=128<<l%32,r[(l+64>>>9<<4)+14]=l;for(var n=1732584193,a=-271733879,f=-1732584194,e=271733878,t=0;t<r.length;t+=16){var s=n,d=a,i=f,u=e;n=o(n,a,f,e,r[t+0],7,-680876936),e=o(e,n,a,f,r[t+1],12,-389564586),f=o(f,e,n,a,r[t+2],17,606105819),a=o(a,f,e,n,r[t+3],22,-1044525330),n=o(n,a,f,e,r[t+4],7,-176418897),e=o(e,n,a,f,r[t+5],12,1200080426),f=o(f,e,n,a,r[t+6],17,-1473231341),a=o(a,f,e,n,r[t+7],22,-45705983),n=o(n,a,f,e,r[t+8],7,1770035416),e=o(e,n,a,f,r[t+9],12,-1958414417),f=o(f,e,n,a,r[t+10],17,-42063),a=o(a,f,e,n,r[t+11],22,-1990404162),n=o(n,a,f,e,r[t+12],7,1804603682),e=o(e,n,a,f,r[t+13],12,-40341101),f=o(f,e,n,a,r[t+14],17,-1502002290),a=o(a,f,e,n,r[t+15],22,1236535329),n=x(n,a,f,e,r[t+1],5,-165796510),e=x(e,n,a,f,r[t+6],9,-1069501632),f=x(f,e,n,a,r[t+11],14,643717713),a=x(a,f,e,n,r[t+0],20,-373897302),n=x(n,a,f,e,r[t+5],5,-701558691),e=x(e,n,a,f,r[t+10],9,38016083),f=x(f,e,n,a,r[t+15],14,-660478335),a=x(a,f,e,n,r[t+4],20,-405537848),n=x(n,a,f,e,r[t+9],5,568446438),e=x(e,n,a,f,r[t+14],9,-1019803690),f=x(f,e,n,a,r[t+3],14,-187363961),a=x(a,f,e,n,r[t+8],20,1163531501),n=x(n,a,f,e,r[t+13],5,-1444681467),e=x(e,n,a,f,r[t+2],9,-51403784),f=x(f,e,n,a,r[t+7],14,1735328473),a=x(a,f,e,n,r[t+12],20,-1926607734),n=h(n,a,f,e,r[t+5],4,-378558),e=h(e,n,a,f,r[t+8],11,-2022574463),f=h(f,e,n,a,r[t+11],16,1839030562),a=h(a,f,e,n,r[t+14],23,-35309556),n=h(n,a,f,e,r[t+1],4,-1530992060),e=h(e,n,a,f,r[t+4],11,1272893353),f=h(f,e,n,a,r[t+7],16,-155497632),a=h(a,f,e,n,r[t+10],23,-1094730640),n=h(n,a,f,e,r[t+13],4,681279174),e=h(e,n,a,f,r[t+0],11,-358537222),f=h(f,e,n,a,r[t+3],16,-722521979),a=h(a,f,e,n,r[t+6],23,76029189),n=h(n,a,f,e,r[t+9],4,-640364487),e=h(e,n,a,f,r[t+12],11,-421815835),f=h(f,e,n,a,r[t+15],16,530742520),a=h(a,f,e,n,r[t+2],23,-995338651),n=v(n,a,f,e,r[t+0],6,-198630844),e=v(e,n,a,f,r[t+7],10,1126891415),f=v(f,e,n,a,r[t+14],15,-1416354905),a=v(a,f,e,n,r[t+5],21,-57434055),n=v(n,a,f,e,r[t+12],6,1700485571),e=v(e,n,a,f,r[t+3],10,-1894986606),f=v(f,e,n,a,r[t+10],15,-1051523),a=v(a,f,e,n,r[t+1],21,-2054922799),n=v(n,a,f,e,r[t+8],6,1873313359),e=v(e,n,a,f,r[t+15],10,-30611744),f=v(f,e,n,a,r[t+6],15,-1560198380),a=v(a,f,e,n,r[t+13],21,1309151649),n=v(n,a,f,e,r[t+4],6,-145523070),e=v(e,n,a,f,r[t+11],10,-1120210379),f=v(f,e,n,a,r[t+2],15,718787259),a=v(a,f,e,n,r[t+9],21,-343485551),n=b(n,s),a=b(a,d),f=b(f,i),e=b(e,u)}return[n,a,f,e]}function _(r,l,n,a,f,e){return b(p(b(b(l,r),b(a,e)),f),n)}function o(r,l,n,a,f,e,t){return _(l&n|~l&a,r,l,f,e,t)}function x(r,l,n,a,f,e,t){return _(l&a|n&~a,r,l,f,e,t)}function h(r,l,n,a,f,e,t){return _(l^n^a,r,l,f,e,t)}function v(r,l,n,a,f,e,t){return _(n^(l|~a),r,l,f,e,t)}function b(r,l){var n=(r&65535)+(l&65535),a=(r>>16)+(l>>16)+(n>>16);return a<<16|n&65535}function p(r,l){return r<<l|r>>>32-l}return D=function(l){return m(l,w)},D}var L,J;function v0(){if(J)return L;J=1;var m=i0().Transform,w=e0();function _(o){m.call(this),this._block=new E.Buffer(o),this._blockSize=o,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}return w(_,m),_.prototype._transform=function(o,x,h){var v=null;try{x!=="buffer"&&(o=new E.Buffer(o,x)),this.update(o)}catch(b){v=b}h(v)},_.prototype._flush=function(o){var x=null;try{this.push(this._digest())}catch(h){x=h}o(x)},_.prototype.update=function(o,x){if(!E.Buffer.isBuffer(o)&&typeof o!="string")throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Digest already called");E.Buffer.isBuffer(o)||(o=new E.Buffer(o,x||"binary"));for(var h=this._block,v=0;this._blockOffset+o.length-v>=this._blockSize;){for(var b=this._blockOffset;b<this._blockSize;)h[b++]=o[v++];this._update(),this._blockOffset=0}for(;v<o.length;)h[this._blockOffset++]=o[v++];for(var p=0,r=o.length*8;r>0;++p)this._length[p]+=r,r=this._length[p]/4294967296|0,r>0&&(this._length[p]-=4294967296*r);return this},_.prototype._update=function(o){throw new Error("_update is not implemented")},_.prototype.digest=function(o){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var x=this._digest();return o!==void 0&&(x=x.toString(o)),x},_.prototype._digest=function(){throw new Error("_digest is not implemented")},L=_,L}var T,Q;function x0(){if(Q)return T;Q=1;var m=e0(),w=v0();function _(){w.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}m(_,w),_.prototype._update=function(){for(var r=new Array(16),l=0;l<16;++l)r[l]=this._block.readInt32LE(l*4);var n=this._a,a=this._b,f=this._c,e=this._d,t=this._e;n=x(n,a,f,e,t,r[0],0,11),f=o(f,10),t=x(t,n,a,f,e,r[1],0,14),a=o(a,10),e=x(e,t,n,a,f,r[2],0,15),n=o(n,10),f=x(f,e,t,n,a,r[3],0,12),t=o(t,10),a=x(a,f,e,t,n,r[4],0,5),e=o(e,10),n=x(n,a,f,e,t,r[5],0,8),f=o(f,10),t=x(t,n,a,f,e,r[6],0,7),a=o(a,10),e=x(e,t,n,a,f,r[7],0,9),n=o(n,10),f=x(f,e,t,n,a,r[8],0,11),t=o(t,10),a=x(a,f,e,t,n,r[9],0,13),e=o(e,10),n=x(n,a,f,e,t,r[10],0,14),f=o(f,10),t=x(t,n,a,f,e,r[11],0,15),a=o(a,10),e=x(e,t,n,a,f,r[12],0,6),n=o(n,10),f=x(f,e,t,n,a,r[13],0,7),t=o(t,10),a=x(a,f,e,t,n,r[14],0,9),e=o(e,10),n=x(n,a,f,e,t,r[15],0,8),f=o(f,10),t=h(t,n,a,f,e,r[7],1518500249,7),a=o(a,10),e=h(e,t,n,a,f,r[4],1518500249,6),n=o(n,10),f=h(f,e,t,n,a,r[13],1518500249,8),t=o(t,10),a=h(a,f,e,t,n,r[1],1518500249,13),e=o(e,10),n=h(n,a,f,e,t,r[10],1518500249,11),f=o(f,10),t=h(t,n,a,f,e,r[6],1518500249,9),a=o(a,10),e=h(e,t,n,a,f,r[15],1518500249,7),n=o(n,10),f=h(f,e,t,n,a,r[3],1518500249,15),t=o(t,10),a=h(a,f,e,t,n,r[12],1518500249,7),e=o(e,10),n=h(n,a,f,e,t,r[0],1518500249,12),f=o(f,10),t=h(t,n,a,f,e,r[9],1518500249,15),a=o(a,10),e=h(e,t,n,a,f,r[5],1518500249,9),n=o(n,10),f=h(f,e,t,n,a,r[2],1518500249,11),t=o(t,10),a=h(a,f,e,t,n,r[14],1518500249,7),e=o(e,10),n=h(n,a,f,e,t,r[11],1518500249,13),f=o(f,10),t=h(t,n,a,f,e,r[8],1518500249,12),a=o(a,10),e=v(e,t,n,a,f,r[3],1859775393,11),n=o(n,10),f=v(f,e,t,n,a,r[10],1859775393,13),t=o(t,10),a=v(a,f,e,t,n,r[14],1859775393,6),e=o(e,10),n=v(n,a,f,e,t,r[4],1859775393,7),f=o(f,10),t=v(t,n,a,f,e,r[9],1859775393,14),a=o(a,10),e=v(e,t,n,a,f,r[15],1859775393,9),n=o(n,10),f=v(f,e,t,n,a,r[8],1859775393,13),t=o(t,10),a=v(a,f,e,t,n,r[1],1859775393,15),e=o(e,10),n=v(n,a,f,e,t,r[2],1859775393,14),f=o(f,10),t=v(t,n,a,f,e,r[7],1859775393,8),a=o(a,10),e=v(e,t,n,a,f,r[0],1859775393,13),n=o(n,10),f=v(f,e,t,n,a,r[6],1859775393,6),t=o(t,10),a=v(a,f,e,t,n,r[13],1859775393,5),e=o(e,10),n=v(n,a,f,e,t,r[11],1859775393,12),f=o(f,10),t=v(t,n,a,f,e,r[5],1859775393,7),a=o(a,10),e=v(e,t,n,a,f,r[12],1859775393,5),n=o(n,10),f=b(f,e,t,n,a,r[1],2400959708,11),t=o(t,10),a=b(a,f,e,t,n,r[9],2400959708,12),e=o(e,10),n=b(n,a,f,e,t,r[11],2400959708,14),f=o(f,10),t=b(t,n,a,f,e,r[10],2400959708,15),a=o(a,10),e=b(e,t,n,a,f,r[0],2400959708,14),n=o(n,10),f=b(f,e,t,n,a,r[8],2400959708,15),t=o(t,10),a=b(a,f,e,t,n,r[12],2400959708,9),e=o(e,10),n=b(n,a,f,e,t,r[4],2400959708,8),f=o(f,10),t=b(t,n,a,f,e,r[13],2400959708,9),a=o(a,10),e=b(e,t,n,a,f,r[3],2400959708,14),n=o(n,10),f=b(f,e,t,n,a,r[7],2400959708,5),t=o(t,10),a=b(a,f,e,t,n,r[15],2400959708,6),e=o(e,10),n=b(n,a,f,e,t,r[14],2400959708,8),f=o(f,10),t=b(t,n,a,f,e,r[5],2400959708,6),a=o(a,10),e=b(e,t,n,a,f,r[6],2400959708,5),n=o(n,10),f=b(f,e,t,n,a,r[2],2400959708,12),t=o(t,10),a=p(a,f,e,t,n,r[4],2840853838,9),e=o(e,10),n=p(n,a,f,e,t,r[0],2840853838,15),f=o(f,10),t=p(t,n,a,f,e,r[5],2840853838,5),a=o(a,10),e=p(e,t,n,a,f,r[9],2840853838,11),n=o(n,10),f=p(f,e,t,n,a,r[7],2840853838,6),t=o(t,10),a=p(a,f,e,t,n,r[12],2840853838,8),e=o(e,10),n=p(n,a,f,e,t,r[2],2840853838,13),f=o(f,10),t=p(t,n,a,f,e,r[10],2840853838,12),a=o(a,10),e=p(e,t,n,a,f,r[14],2840853838,5),n=o(n,10),f=p(f,e,t,n,a,r[1],2840853838,12),t=o(t,10),a=p(a,f,e,t,n,r[3],2840853838,13),e=o(e,10),n=p(n,a,f,e,t,r[8],2840853838,14),f=o(f,10),t=p(t,n,a,f,e,r[11],2840853838,11),a=o(a,10),e=p(e,t,n,a,f,r[6],2840853838,8),n=o(n,10),f=p(f,e,t,n,a,r[15],2840853838,5),t=o(t,10),a=p(a,f,e,t,n,r[13],2840853838,6),e=o(e,10);var s=this._a,d=this._b,i=this._c,u=this._d,c=this._e;s=p(s,d,i,u,c,r[5],1352829926,8),i=o(i,10),c=p(c,s,d,i,u,r[14],1352829926,9),d=o(d,10),u=p(u,c,s,d,i,r[7],1352829926,9),s=o(s,10),i=p(i,u,c,s,d,r[0],1352829926,11),c=o(c,10),d=p(d,i,u,c,s,r[9],1352829926,13),u=o(u,10),s=p(s,d,i,u,c,r[2],1352829926,15),i=o(i,10),c=p(c,s,d,i,u,r[11],1352829926,15),d=o(d,10),u=p(u,c,s,d,i,r[4],1352829926,5),s=o(s,10),i=p(i,u,c,s,d,r[13],1352829926,7),c=o(c,10),d=p(d,i,u,c,s,r[6],1352829926,7),u=o(u,10),s=p(s,d,i,u,c,r[15],1352829926,8),i=o(i,10),c=p(c,s,d,i,u,r[8],1352829926,11),d=o(d,10),u=p(u,c,s,d,i,r[1],1352829926,14),s=o(s,10),i=p(i,u,c,s,d,r[10],1352829926,14),c=o(c,10),d=p(d,i,u,c,s,r[3],1352829926,12),u=o(u,10),s=p(s,d,i,u,c,r[12],1352829926,6),i=o(i,10),c=b(c,s,d,i,u,r[6],1548603684,9),d=o(d,10),u=b(u,c,s,d,i,r[11],1548603684,13),s=o(s,10),i=b(i,u,c,s,d,r[3],1548603684,15),c=o(c,10),d=b(d,i,u,c,s,r[7],1548603684,7),u=o(u,10),s=b(s,d,i,u,c,r[0],1548603684,12),i=o(i,10),c=b(c,s,d,i,u,r[13],1548603684,8),d=o(d,10),u=b(u,c,s,d,i,r[5],1548603684,9),s=o(s,10),i=b(i,u,c,s,d,r[10],1548603684,11),c=o(c,10),d=b(d,i,u,c,s,r[14],1548603684,7),u=o(u,10),s=b(s,d,i,u,c,r[15],1548603684,7),i=o(i,10),c=b(c,s,d,i,u,r[8],1548603684,12),d=o(d,10),u=b(u,c,s,d,i,r[12],1548603684,7),s=o(s,10),i=b(i,u,c,s,d,r[4],1548603684,6),c=o(c,10),d=b(d,i,u,c,s,r[9],1548603684,15),u=o(u,10),s=b(s,d,i,u,c,r[1],1548603684,13),i=o(i,10),c=b(c,s,d,i,u,r[2],1548603684,11),d=o(d,10),u=v(u,c,s,d,i,r[15],1836072691,9),s=o(s,10),i=v(i,u,c,s,d,r[5],1836072691,7),c=o(c,10),d=v(d,i,u,c,s,r[1],1836072691,15),u=o(u,10),s=v(s,d,i,u,c,r[3],1836072691,11),i=o(i,10),c=v(c,s,d,i,u,r[7],1836072691,8),d=o(d,10),u=v(u,c,s,d,i,r[14],1836072691,6),s=o(s,10),i=v(i,u,c,s,d,r[6],1836072691,6),c=o(c,10),d=v(d,i,u,c,s,r[9],1836072691,14),u=o(u,10),s=v(s,d,i,u,c,r[11],1836072691,12),i=o(i,10),c=v(c,s,d,i,u,r[8],1836072691,13),d=o(d,10),u=v(u,c,s,d,i,r[12],1836072691,5),s=o(s,10),i=v(i,u,c,s,d,r[2],1836072691,14),c=o(c,10),d=v(d,i,u,c,s,r[10],1836072691,13),u=o(u,10),s=v(s,d,i,u,c,r[0],1836072691,13),i=o(i,10),c=v(c,s,d,i,u,r[4],1836072691,7),d=o(d,10),u=v(u,c,s,d,i,r[13],1836072691,5),s=o(s,10),i=h(i,u,c,s,d,r[8],2053994217,15),c=o(c,10),d=h(d,i,u,c,s,r[6],2053994217,5),u=o(u,10),s=h(s,d,i,u,c,r[4],2053994217,8),i=o(i,10),c=h(c,s,d,i,u,r[1],2053994217,11),d=o(d,10),u=h(u,c,s,d,i,r[3],2053994217,14),s=o(s,10),i=h(i,u,c,s,d,r[11],2053994217,14),c=o(c,10),d=h(d,i,u,c,s,r[15],2053994217,6),u=o(u,10),s=h(s,d,i,u,c,r[0],2053994217,14),i=o(i,10),c=h(c,s,d,i,u,r[5],2053994217,6),d=o(d,10),u=h(u,c,s,d,i,r[12],2053994217,9),s=o(s,10),i=h(i,u,c,s,d,r[2],2053994217,12),c=o(c,10),d=h(d,i,u,c,s,r[13],2053994217,9),u=o(u,10),s=h(s,d,i,u,c,r[9],2053994217,12),i=o(i,10),c=h(c,s,d,i,u,r[7],2053994217,5),d=o(d,10),u=h(u,c,s,d,i,r[10],2053994217,15),s=o(s,10),i=h(i,u,c,s,d,r[14],2053994217,8),c=o(c,10),d=x(d,i,u,c,s,r[12],0,8),u=o(u,10),s=x(s,d,i,u,c,r[15],0,5),i=o(i,10),c=x(c,s,d,i,u,r[10],0,12),d=o(d,10),u=x(u,c,s,d,i,r[4],0,9),s=o(s,10),i=x(i,u,c,s,d,r[1],0,12),c=o(c,10),d=x(d,i,u,c,s,r[5],0,5),u=o(u,10),s=x(s,d,i,u,c,r[8],0,14),i=o(i,10),c=x(c,s,d,i,u,r[7],0,6),d=o(d,10),u=x(u,c,s,d,i,r[6],0,8),s=o(s,10),i=x(i,u,c,s,d,r[2],0,13),c=o(c,10),d=x(d,i,u,c,s,r[13],0,6),u=o(u,10),s=x(s,d,i,u,c,r[14],0,5),i=o(i,10),c=x(c,s,d,i,u,r[0],0,15),d=o(d,10),u=x(u,c,s,d,i,r[3],0,13),s=o(s,10),i=x(i,u,c,s,d,r[9],0,11),c=o(c,10),d=x(d,i,u,c,s,r[11],0,11),u=o(u,10);var B=this._b+f+u|0;this._b=this._c+e+c|0,this._c=this._d+t+s|0,this._d=this._e+n+d|0,this._e=this._a+a+i|0,this._a=B},_.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var r=new E.Buffer(20);return r.writeInt32LE(this._a,0),r.writeInt32LE(this._b,4),r.writeInt32LE(this._c,8),r.writeInt32LE(this._d,12),r.writeInt32LE(this._e,16),r};function o(r,l){return r<<l|r>>>32-l}function x(r,l,n,a,f,e,t,s){return o(r+(l^n^a)+e+t|0,s)+f|0}function h(r,l,n,a,f,e,t,s){return o(r+(l&n|~l&a)+e+t|0,s)+f|0}function v(r,l,n,a,f,e,t,s){return o(r+((l|~n)^a)+e+t|0,s)+f|0}function b(r,l,n,a,f,e,t,s){return o(r+(l&a|n&~a)+e+t|0,s)+f|0}function p(r,l,n,a,f,e,t,s){return o(r+(l^(n|~a))+e+t|0,s)+f|0}return T=_,T}var O,W;function n0(){if(W)return O;W=1;var m=K().Buffer,w=d0(),_=typeof Uint8Array<"u",o=_&&typeof ArrayBuffer<"u",x=o&&ArrayBuffer.isView;return O=function(h,v,b){if(typeof h=="string"||m.isBuffer(h)||_&&h instanceof Uint8Array||x&&x(h))return w(h,v);throw new TypeError(b+" must be a string, a Buffer, a Uint8Array, or a DataView")},O}var M,Y;function f0(){if(Y)return M;Y=1;var m=h0(),w=x0(),_=u0(),o=K().Buffer,x=t0(),h=a0(),v=n0(),b=o.alloc(128),p={__proto__:null,md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,"sha512-256":32,ripemd160:20,rmd160:20},r={__proto__:null,"sha-1":"sha1","sha-224":"sha224","sha-256":"sha256","sha-384":"sha384","sha-512":"sha512","ripemd-160":"ripemd160"};function l(e){return new w().update(e).digest()}function n(e){function t(s){return _(e).update(s).digest()}return e==="rmd160"||e==="ripemd160"?l:e==="md5"?m:t}function a(e,t,s){var d=n(e),i=e==="sha512"||e==="sha384"?128:64;t.length>i?t=d(t):t.length<i&&(t=o.concat([t,b],i));for(var u=o.allocUnsafe(i+p[e]),c=o.allocUnsafe(i+p[e]),B=0;B<i;B++)u[B]=t[B]^54,c[B]=t[B]^92;var g=o.allocUnsafe(i+s+4);u.copy(g,0,0,i),this.ipad1=g,this.ipad2=u,this.opad=c,this.alg=e,this.blocksize=i,this.hash=d,this.size=p[e]}a.prototype.run=function(e,t){e.copy(t,this.blocksize);var s=this.hash(t);return s.copy(this.opad,this.blocksize),this.hash(this.opad)};function f(e,t,s,d,i){x(s,d),e=v(e,h,"Password"),t=v(t,h,"Salt");var u=(i||"sha1").toLowerCase(),c=r[u]||u,B=p[c];if(typeof B!="number"||!B)throw new TypeError("Digest algorithm not supported: "+i);var g=new a(c,e,t.length),C=o.allocUnsafe(d),A=o.allocUnsafe(t.length+4);t.copy(A,0,0,t.length);for(var N=0,k=B,o0=Math.ceil(d/k),H=1;H<=o0;H++){A.writeUInt32BE(H,t.length);for(var I=g.run(A,g.ipad1),z=I,V=1;V<s;V++){z=g.run(z,g.ipad2);for(var q=0;q<k;q++)I[q]^=z[q]}I.copy(C,N),N+=k}return C}return M=f,M}var U,j;function b0(){if(j)return U;j=1;var m=K().Buffer,w=t0(),_=a0(),o=f0(),x=n0(),h,v=y.crypto&&y.crypto.subtle,b={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},p=[],r;function l(){return r||(y.process&&y.process.nextTick?r=y.process.nextTick:y.queueMicrotask?r=y.queueMicrotask:y.setImmediate?r=y.setImmediate:r=y.setTimeout,r)}function n(e,t,s,d,i){return v.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]).then(function(u){return v.deriveBits({name:"PBKDF2",salt:t,iterations:s,hash:{name:i}},u,d<<3)}).then(function(u){return m.from(u)})}function a(e){if(y.process&&!y.process.browser||!v||!v.importKey||!v.deriveBits)return Promise.resolve(!1);if(p[e]!==void 0)return p[e];h=h||m.alloc(8);var t=n(h,h,10,128,e).then(function(){return!0},function(){return!1});return p[e]=t,t}function f(e,t){e.then(function(s){l()(function(){t(null,s)})},function(s){l()(function(){t(s)})})}return U=function(e,t,s,d,i,u){typeof i=="function"&&(u=i,i=void 0),i=i||"sha1";var c=b[i.toLowerCase()];if(!c||typeof y.Promise!="function"){l()(function(){var B;try{B=o(e,t,s,d,i)}catch(g){u(g);return}u(null,B)});return}if(w(s,d),e=x(e,_,"Password"),t=x(t,_,"Salt"),typeof u!="function")throw new Error("No callback provided to pbkdf2");f(a(c).then(function(B){return B?n(e,t,s,d,c):o(e,t,s,d,i)}),u)},U}var r0;function q0(){return r0||(r0=1,S.pbkdf2=b0(),S.pbkdf2Sync=f0()),S}export{q0 as r};
